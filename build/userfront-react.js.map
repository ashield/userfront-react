{"version":3,"file":"userfront-react.js","sources":["../src/index.js"],"sourcesContent":["import React, { memo } from \"react\";\n// import core from \"./core.map.js\";\nimport AnyMod from \"@anymod/core\";\nimport Core from \"@userfront/core\";\n\nconst {\n  Singleton,\n  alias,\n  // render,\n  processPage,\n  createOrReturnPage,\n  checkPageAndUpdate,\n  executeCallbacks,\n  logErrorsAndTips,\n} = AnyMod;\n\nalias.setAlias(\"Userfront\");\nSingleton.Opts.api = true;\n\nCore.registerUrlChangedEventListener();\nwindow.addEventListener(\"urlchanged\", () => {\n  console.log(\"urlchanged\");\n  // render();\n});\n\nasync function mountTools() {\n  try {\n    const page = await createOrReturnPage();\n    const updatedPage = await checkPageAndUpdate(page);\n    await processPage(updatedPage);\n    executeCallbacks();\n    logErrorsAndTips();\n  } catch (err) {\n    let message = err && err.message ? err.message : \"Problem loading page\";\n    console.warn(message, err);\n  }\n}\n\nconst Userfront = {\n  build({ tenantId, toolId }) {\n    class Anon extends React.Component {\n      componentDidMount() {\n        mountTools();\n      }\n      render() {\n        return (\n          <div>\n            <div id={`userfront-${toolId}`}></div>\n          </div>\n        );\n      }\n    }\n    return memo(Anon);\n  },\n  /**\n   * This is the hook way to do it, which we're not\n   * using because it's not compatible with older\n   * versions of React.\n   */\n  // hook({ tenantId, toolId }) {\n  //   return function Anon() {\n  //     useEffect(() => {\n  //       mount();\n  //     });\n  //     return (\n  //       <div>\n  //         <div id={`userfront-${toolId}`}></div>\n  //       </div>\n  //     );\n  //   };\n  // },\n};\n\nfor (const attr in Core) {\n  if (!Userfront[attr]) Userfront[attr] = Core[attr];\n}\n\nexport default Userfront;\n"],"names":["Singleton","alias","processPage","createOrReturnPage","checkPageAndUpdate","executeCallbacks","logErrorsAndTips","AnyMod","setAlias","Opts","api","Core","registerUrlChangedEventListener","window","addEventListener","console","log","Userfront","build","toolId","Anon","React","Component","componentDidMount","body","recover","result","page","updatedPage","e","then","err","warn","message","mountTools","render","id","memo","attr"],"mappings":"uKAKMA,UACJA,EADIC,MAEJA,EAFIC,YAIJA,EAJIC,mBAKJA,EALIC,mBAMJA,EANIC,iBAOJA,EAPIC,iBAQJA,GACEC,EAEJN,EAAMO,SAAS,aACfR,EAAUS,KAAKC,KAAM,EAErBC,EAAKC,kCACLC,OAAOC,iBAAiB,aAAc,KACpCC,QAAQC,IAAI,gBAiBd,MAAMC,EAAY,CAChBC,OAAMC,OAAYA,IAChB,MAAMC,UAAaC,EAAMC,UACvBC,4CAygBC,SAAgBC,EAAMC,GAC5B,IACC,IAAIC,kBAzhBiBvB,mBAAbwB,0BACoBvB,EAAmBuB,kBAAvCC,0BACA1B,EAAY0B,oBAClBvB,IACAC,UAshBD,MAAMuB,GACP,OAAOJ,EAAQI,GAEhB,OAAIH,GAAUA,EAAOI,KACbJ,EAAOI,UAAK,EAAQL,GAErBC,cA3hBGK,GAEPhB,QAAQiB,KADMD,GAAOA,EAAIE,QAAUF,EAAIE,QAAU,uBAC3BF,+FAQlBG,GAEFC,SACE,OACEd,2BACEA,uBAAKe,GAAK,aAAYjB,MAK9B,OAAOkB,OAAKjB,KAqBhB,IAAK,MAAMkB,KAAQ3B,EACZM,EAAUqB,KAAOrB,EAAUqB,GAAQ3B,EAAK2B"}